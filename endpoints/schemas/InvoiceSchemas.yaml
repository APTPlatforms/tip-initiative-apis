openapi: "3.0.0"
info:
  title: Invoice Schema
  version: 1.0.0.
  description: Invoice Schema, Based on TIP 4.0 Working Draft
  termsOfService: http://placeholderdomain.io/terms/,
  contact: 
    name: MIT
    email: tipinitiative@frontrowadvisory.com
    url: http://placeholderdomain.io
  license: 
    name: MIT
    url: https://opensource.org/licenses/MIT
paths: {} 
components: 
  schemas: 
    invoiceObject: 
      required: 
      - transactionHeader
      - referenceId
      - invoiceDate
      - calendarType
      - billingCycle
      - billingGranularity
      - startDate
      - endDate
      - Buyer
      - Advertiser
      - buylineCashTrade
      - grossAmount
      - Commission
      - totalNetDollars
      - remittanceInfo
      properties:
        transactionHeader: 
          $ref: 'commonSchemas.yaml#/components/schemas/transactionHeader'
        referenceId:
          description: Information grouping all reference ids and their source that are associated to the proposal
          type: array
          items:
            $ref: 'commonSchemas.yaml#/components/schemas/referenceIds'
        invoiceDate:
          description: Date in which the original invoice was generated
          type: string
          format: date
        invoiceRevisionDate:
          description: Required for Invoice Revision â€“ Date in which the invoice revision was generated
          type: string
          format: date
        calenderType:
          description: The invoice calendar type
          type: string
          enum: [Broadcast, Calendar]
        billingCycle:
          description: The nvoice billing cycle
          type: string
          enum: [Monthy, Weekly]
        billingGranularity:
          description: The invoice billing granilarity
          type: string
          enum: [Order, Brand, InsertionOrder]
        dueDate:
          description: Date in which payment is due on invoice
          type: string
          format: date
        startDate:
          description: First broadcast date valid for the invoice period
          type: string
          format: date
        endDate:
          description: Last broadcast date valid for the invoice period
          type: string
          format: date
        businessType:
          description: Seller-defined type of business
          type: string
        Buyer:
          $ref: 'commonSchemas.yaml#/components/schemas/Buyer'
        localNational:
          type: string
          enum: [Local, National]
        Advertiser:
          $ref: 'commonSchemas.yaml#/components/schemas/Advertiser'
        Contact:
          $ref: 'commonSchemas.yaml#/components/schemas/Contact'
        buylineCashTrade:
          description: Revenue Type associated to the order
          type: string
          enum: [Cash, Barter, Trade]
        grossAmount:
          description: Total gross dollar for the invoice
          type: number
          format: float
        Commission:
          description: Seller commission dollars
          type: number
          format: float
        salesTax:
          description: Sales Tax in USD applied to any elements on the invoice
          type: number
          format: float
        totalNetDollars:
          description: Total net dollars for all units with the invoice (grossamount - commission)
          type: number
        remittanceInfo:
          description: refer to remittance object for data property details  #TO DO
          $ref: 'commonSchemas.yaml#/components/schemas/remittanceInfo'
        externalComment:
          description: free form text to accomodate transaction
          type: string
        lineDetails:
          description: Line details array of lines
          type: array
          items:
            type: object
            required:
              - buyLineIDReference
              - unitType
              - mediaOutlet
              - Product
              - salesElement
              - lineStartDate
              - lineEndDate
              - Length
              # - UnitDetails
            properties:
              buyLineIDReference:
                description: Seller's Line information (add buyer identifier make optional) 
                type: string
              buyLineIDName:
                description:  Name associated to the line
                type: string
              unitType:
                description: Type of invoice units
                type: string
                enum: [Units, Impressions, NonAirTime]
              audienceMetric:
                $ref: 'commonSchemas.yaml#/components/schemas/audienceMetric'
              totalUnits:
                description: Total number of raw (equivalized) units (based on invoice's unit type) within the start and end date
                type: number
              mediaOutlet:
                $ref: 'commonSchemas.yaml#/components/schemas/mediaOutlet'
              Brand:
                description: Brand Id & Name
                $ref: 'commonSchemas.yaml#/components/schemas/Brand'
              Product:
                $ref: 'commonSchemas.yaml#/components/schemas/Product'
              salesElement:
                description: Sales Element Name
                type: string
              Program:
                description: Program Name
                type: string
              cpeCode:
                #description: Client Code, Product Code & Estimate Code associated to the unit
                $ref: 'commonSchemas.yaml#/components/schemas/cpeCode'
              timeFrame:
                $ref: 'commonSchemas.yaml#/components/schemas/timeFrame'
              billableRevenue:
                description: Rate's Billable revenue type
                type: string
                enum: [Booked, Actuals]
              Rate:
                type: number
                format: float
              lineStartDate:
                description: start date of line
                type: string
                format: startDate
              lineEndDate:
                description: end date of line
                type: string
                format: date
              inventoryType:
                description: Inventory Type associated to unit  (Further Define in order to support cross 
                type: string
                enum: [Commercial, Interstitial, Billboard]
              Length:
                description: Length of commercial unit
                type: integer
              UnitDetails:
                description: Array of unit details, applicable only when UnitType=Units
                type: array
                items:
                  type: object
                  required:
                    - unitId
                  properties:
                    unitId:
                      description: Seller generated unique number, required
                      type: string
                    adId:
                      type: string
                    broadcastDate:
                      $ref: 'commonSchemas.yaml#/components/schemas/broadcastDate'
                    podPosition:
                      type: string
                      enum: [First, Middle, Last]
                    linkType:
                      type: string
                      enum: [Billboard, Piggyback, Bookend, Sponsorship, Package]
                    linkNum:
                      type: integer
                    linkSeq:
                      type: integer
                    Preempt:
                      type: boolean
                    Makegood: 
                      type: boolean
                    ADU:
                      type: boolean
                    Bonus:
                      type: boolean
                    Rate:
                      type: number
                      format: float
                    Credit:
                      type: boolean
                    adjustmentReason:
                      type: string
                    Comment:
                      type: string   
                    childUnitDetails:
                      description: Child unit details for footprint unit to support Audience
                      type: array
                      items:
                        type: object
                        required:
                          - parentUnitId
                          - unitId
                        properties:
                          ParentUnitId:
                            type: string
                          unitId:
                            type: string
                          mediaOutlet:
                            $ref: 'commonSchemas.yaml#/components/schemas/mediaOutlet'
                          Rate:
                            type: number
                            format: float
                          adId:
                            type: string
                          Preempt:
                            type: boolean
                          Makegood: 
                            type: boolean
                          ADU:
                            type: boolean
                          Credit:
                            type: boolean
                          adjustmentReason:
                            type: string
                          broadcastDate:
                            $ref: 'commonSchemas.yaml#/components/schemas/broadcastDate'